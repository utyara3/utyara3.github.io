---
layout: content-layout.njk
title: Скорость атаки
description: Состояния оружий, сокращение кадров атаки
author: utyara3
order: 7
---

## Скорость атаки

Скорость атаки относится к скорости, с которой оружие атакует. Она может варьироваться от жалких 0,5 скорости атаки до 30 скорости атаки.

Скорость атаки измеряется путем получения суммы кадров для всех состояний предмета и деления 30 (количество кадров в секунду) на нее. Например, если предмету требуется 20 кадров для завершения атаки, скорость атаки предмета составляет 1,5 (30/20 = 1,5), что обычно обозначается как авс (атаки в секунду) или апс (от англ. attacks per seconds). Вот так: 1,5 aps/авс/апс.

Некоторые предметы с быстрой скоростью атаки:

- Многозарядный арбалет (10 авс)
- Рунный меч (6 авс)
- Каменный меч (7.5 авс)

Некоторые предметы с самой медленной скоростю атаки:

- КПБ (Клинок Павшего Бога) (0.5 авс)
- Бердыш (1 авс)
- Рунный камень (0.7 авс)

DPS (damage per second - урон в секунду) показывается в игре при нажатии на оружие. Рассчитывается как `урон предмета / количество атак в секунду`

Обратите внимание, что сюда не входят элементальный урон или критические удары.

### Состояния оружия

Состояния оружия относятся к четырем состояниям, в которых оно может находиться в любой момент времени.

Эти состояния определяют, что делает предмет; у каждого предмета есть четыре состояния, но три из них используются в бою. Четыре состояния перечислены здесь:

- **Idle (Айдл)**  
    Состояние 1, или состояние бездействия, относится к состоянию, когда предмет или игрок не находится в бою. Например, при использовании каменного жезла, если игрок не находится в пределах досягаемости врага, жезл находится в состоянии бездействия.

- **Cast (Каст)**  
    Состояние 2, или состояние каста, относится к состоянию, когда предмет готовится к атаке. Например, при использовании Клинка Падшего Бога игрок поднимает клинок, чтобы ударить, тогда клинок находится в состоянии каста. В последнем кадре состояния каста предмет нанесет свой урон.

- **Perf (Перф)**  
    Состояние 3, или состояние Perf, относится к моменту, когда предмет нанес урон врагу. Например, когда клинок обрушивается на врага, он находится в состоянии перф. Это состояние представляет собой анимацию после нанесения урона и может быть пропущено при помощи ПАА.

- **Cooldown (Кулдаун, перезарядка, кд)**  
    Состояние 4, или состояние кулдауна, относится к моменту, когда предмет заканчивает атаковать, и следует за состоянием перф. Например, после того, как игрок использует меч, он должен сначала "перезарядится", прежде чем снова атаковать и перейти в состояние 2. Если сразу после нанесения урона убрать предмет, то он будет пассивно перезаряжаться, но останется 1 кадр перезарядки, который вам нужно будет передержать в руках прежде чем предмет снова начнет анимацию атаки. Это можно сделать вне боя, чтобы при атаке не терять кадры, но это уже больше спидраннерские фишки.

Узнать состояние предмета также можно через стоун скрипт, использовав `item.right.state` и `item.left.state` для правой и левой руки соответственно.

### Reduction (Сокращение кадров атаки)

Сокращение относится к уменьшению значений состояний предметов, чтобы сделать их быстрее.

В этом разделе состояния будут отображаться так: 2/3/4 состояния

Кадры уменьшения могут относиться как к каждому состоянию предмета, так и распределяться между ними.

Например, зелье берсерка действует на все состояния.
Берсерк уменьшает кадры на 5, поэтому, оружие 10/10/10 будет 5/5/5.

Лунный камень же распределяет свои 5 кадров уменьшения между всеми состояниями, и делается немного замурденно.

Дело в чем: кадров 5, а состояний 3, нацело не делится, поэтому был придуман оффсет - число, определяющее распределение кадров.

Если оффсет 1, то распределение -1/-2/-2. Если оффсет 2, то -2/-1/-2. Если оффсет 0, то -2/-2/-1.

Т.е., если оружие 10/10/10 и имеет 1 оффсет, то будет 9/8/8 и т.д.

Вот поэтапные шаги для рассчета оффсета, расмотренные на примере каменного меча с 0 по 3 уровень:

|Уровень|0 |1 |2 |3 |
|-------|--|--|--|--|
| Каст  |12|11|11|11|
| Перф  |5 |5 |4 |4 |
| Кд    |5 |5 |5 |4 |

Для начала подсчитаем общее количество кадров, нужных для одного цикла:

|Уровень|0 |1 |2 |3 |
|-------|--|--|--|--|
| Всего |22|21|20|19|

Далее получим "общее сокращение", вычтя общее количество кадров из общего количества базовых кадров, что равно 22. Например, для уровня 2 "общее сокращение" равно 22-20 = 2.


| Уровень |0 |1 |2 |3 |
|---------|--|--|--|--|
|  Всего  |22|21|20|19|
|Общ сокр.|0 |1 |2 |3 |

Следующим шагом берем разницу между текущим общим сокращением и прошлым. Например, для 2 уровня, текущее - 2, предыдущее - 1, разница: 2-1=1

| Уровень |0 |1 |2 |3 |
|---------|--|--|--|--|
|  Всего  |22|21|20|19|
|Общ сокр.|0 |1 |2 |3 |
| Разница |0 |1 |1 |1 |

И наконец, получим оффсет: нужно взять оффсет предыдущего уровня, сложить его с разницей прошлого уровня, и взять от полученного значения остаток от деления на 3. Для 0 уровня оффсет всегда 1.

| Уровень |0 |1 |2 |3 |
|---------|--|--|--|--|
|  Всего  |22|21|20|19|
|Общ сокр.|0 |1 |2 |3 |
| Разница |0 |1 |1 |1 |
| Оффсет  |1 |1 |2 |0 |

Теперь, зная оффсет, мы можем узнать распределение уменьшения кадров лунного камня. Можем разглядеть на конкретном примере:

В игре есть техника атаки, называемая мундиалингом, и для нее нужны 2 \*10 +21 рунных меча. Но, но, но, почему бы не взять +20 вместо +21, у них же одинаковые характеристики, они имеют одинаковое количество кадров, нужных для атаки.

Рассмотрим таблицу +20 и +21 мечей(30 уровень - \*10 и +20, 31 уровень - \*10 и +21 уровень, думаю суть уловили):

| Уровень |30|31|
|---------|--|--|
|  Каст   |3 |3 |
|  Перф   |1 |1 |
|  Кд     |1 |1 |
|  Всего  |3 |3 |
|Общ сокр.|31|32|
| Разница |1 |1 |
| Оффсет  |1 |2 |

И тут мы можем заметить, что у меча +20 оффсет 1, а значит кадры распределятся: -1/-2/-2 и меч будет 2/1/1

А +21 меч имеет 2 оффсет, распределение -2/-1/-2 и кадры: 1/1/1.

Пропуская перф при помощи ПАА, мы имеем удар в 1 кадр и 1 кадр перезарядки, что и нужно для мундиалинга.

И, конечно же, каждый раз вам все это считать не нужно, уже есть специальные таблицы, в которых есть вся нужная информация. Они находятся в листах [Item Factory](https://docs.google.com/spreadsheets/d/14AwQNn11qSGf9aQAi89p5QEAKClMnJYvzfDXiuWHtGw/edit). Конкретно таблицы для оффсета находятся в листе Attack Speed Calcs.


